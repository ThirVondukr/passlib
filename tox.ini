[tox]
minversion=1.0
envlist = py27,py32,py25,py26,py31,pypy15,pypy16,pypy17,jython,gae25,gae27

#===========================================================================
# stock CPython VMs
#===========================================================================
[testenv]
setenv =
	PASSLIB_TESTS = all
	PASSLIB_TESTS_FUZZ_TIME = 10
changedir = {envdir}
commands =
	nosetests {posargs:passlib.tests}
deps =
	nose
	unittest2

[testenv:py27]
deps =
	nose
	unittest2
	py-bcrypt
	bcryptor

[testenv:py31]
deps =
    nose
    unittest2py3k

[testenv:py32]
deps =
    nose
    unittest2py3k

#===========================================================================
# PyPy VM - all target Python 2.7
#===========================================================================
[testenv:pypy15]
basepython = pypy1.5

[testenv:pypy16]
basepython = pypy1.6

[testenv:pypy17]
basepython = pypy1.7
setenv =
	PASSLIB_TESTS = all
	PASSLIB_TESTS_FUZZ_TIME = 10
    # this is only interpreter when builtin bcrypt backend
    # isn't punitively slow
    PASSLIB_BUILTIN_BCRYPT = enable

commands =
	nosetests {posargs:passlib.tests}

#===========================================================================
# Jython - no special directives, currently same as py25
#===========================================================================

#===========================================================================
# Google App Engine
#===========================================================================
[testenv:gae25]
basepython = python2.5
deps =
	nose
    # FIXME: getting all kinds of errors when using nosegae 0.2.0 :(
	nosegae==0.1.9
	unittest2
changedir = {envdir}/lib/python2.5/site-packages
commands =
    # setup custom app.yaml so GAE can run
    python -m passlib.tests.tox_support setup_gae . python

	# have to run without sandbox for now, something in nose+GAE+virtualenv
	# won't play nice with eachother.
    nosetests --with-gae --without-sandbox {posargs:passlib/tests}

[testenv:gae27]
basepython = python2.7
deps =
	nose
    # FIXME: getting all kinds of errors when using nosegae 0.2.0 :(
	nosegae==0.1.9
	unittest2
changedir = {envdir}/lib/python2.7/site-packages
commands =
    # setup custom app.yaml so GAE can run
    python -m passlib.tests.tox_support setup_gae . python27

	# have to run without sandbox for now, something in nose/GAE/virtualenv
	# won't play nice with eachother.
    nosetests --with-gae --without-sandbox {posargs:passlib/tests}

#===========================================================================
# EOF
#===========================================================================
